import numpy as np
import sqlite3
import pandas as pd
import time
import pickle

startt = time.time()

conn = sqlite3.connect("C:/Users/Stefano/Documents/reddit.sqlite")
c = conn.cursor()

#acron=['AAMOF', 'ABT', 'ADN', 'AFAIC', 'AFAICT', 'AFAICS', 'AFAIK', 'AIUI', 'AKA', 'ASAP', 'ASL', 'ASL', 'ASLP', 'ASOP', 'ATM', 'AWA', 'AWHFY', 'AWOL', 'AWOL', 'AYOR', 'B4', 'B4N', 'BAC', 'BC', 'BEG', 'BF', 'BFN', 'BG', 'BION', 'BM', 'BMB', 'BKA', 'BRB', 'BRS', 'BS', 'BTDT', 'BTOBS', 'BTSOOM', 'BTW', 'BYOB', 'CAD', 'CADET', 'CDIWY', 'CFV', 'CFY', 'CID', 'CMIIW', 'CNP', 'CRS', 'CSG', 'CTS', 'CU', 'CU2', 'CUL', 'CUL8R', 'CWOT', 'CWYL', 'CYA', 'CYAL8R', 'CYO', 'DBA', 'DCed', 'DFLA', 'DH', 'DIIK', 'DGA', 'DIY', 'DQMOT', 'DND', 'DWAI', 'DWIM', 'DWIMC', 'DWISNWID', 'DYJHIW', 'DYK', 'EAK', 'EIE', 'EG', 'EMFBI', 'EMFJI', 'EMSG', 'EOD', 'EOF', 'EOL', 'EOM', 'EOS', 'EOT', 'ETLA', 'EYC', 'F', 'F2F', 'FAQ', 'FAWC', 'FBOW', 'FBTW', 'FCFS', 'FCOL', 'FIFO', 'FISH', 'FOAF', 'FOB', 'FOC', 'FOCL', 'FOFL', 'FOS', 'FOTCL', 'FTF', 'FTTT', 'FU', 'FUBAR', 'FUCT', 'FURTB', 'FW', 'FWIW', 'FYA', 'FYE', 'FYEO', 'FYI', 'G2B', 'G2G', 'G2GGS2D', 'G2GTAC', 'G2GTAP', 'GA', 'GAFIA', 'GAL', 'GAS', 'GBH', 'GBR', 'GBY', 'GDW', 'GE', 'GF', 'GFETE', 'GFN', 'GFU', 'GG', 'GGU2', 'GIGO', 'GJ', 'GL', 'GL&GH', 'GM', 'GMAB', 'GMAO', 'GMBO', 'GMTA', 'GN', 'GOK', 'GOWI', 'GPF', 'GR8', 'GR&D', 'GtG', 'GTSY', 'H', 'HAK', 'HAGD', 'HAGN', 'HAGS', 'HAG1', 'HAHA', 'HAND', 'HB', 'HB', 'HDYWTDT', 'HF', 'HH', 'HHIS', 'HHJK', 'HHOJ', 'HHOK', 'HHOS', 'HIH', 'HILIACACLO', 'HIWTH', 'HLM', 'HMS', 'HMS', 'HMT', 'HMWK', 'HOAS', 'HSIK', 'HTH', 'HTHBE', 'HYLMS', 'IAAA', 'IAAL', 'IAC', 'IC', 'IAE', 'IAG', 'IBN', 'ICOCBW', 'IDC', 'IDGI', 'IDGW', 'IDI', 'IDK', 'IDTT', 'IFVB', 'IGP', 'IGTP', 'IHTFP', 'IHU', 'IHY', 'II', 'IIT', 'IIR', 'IIRC', 'IJWTK', 'IJWTS', 'IK', 'IKWUM', 'ILBCNU', 'ILU', 'ILY', 'ILYFAE', 'IMAO', 'IMFAO', 'IMBO', 'IMCO', 'IME', 'IMHO', 'IMNSHO', 'IMO', 'IMOBO', 'IMPOV', 'IMP', 'INAL', 'INPO', 'IOIT', 'IOW', 'IRL', 'IRMFI', 'IRSTBO', 'IS', 'ISEN', 'ISTM', 'ISTR', 'ISWYM', 'ITFA', 'ITRO', 'ITRW', 'ITSFWI', 'IVL', 'IWALY', 'IWBNI', 'IYKWIM', 'IYSWIM', 'JAM', 'JAS', 'JASE', 'JAWS', 'JIC', 'JJWY', 'JK', 'JMHO', 'JMO', 'JP', 'JTLYK', 'JW', 'K', 'K', 'KHYF', 'KB', 'KISS', 'KIT', 'KMA', 'KMB', 'KMSMA', 'KOTC', 'KOTL', 'KUTGW', 'KWIM', 'L8R', 'L8R G8R', 'LAB', 'LAM', 'LBR', 'LD', 'LG', 'LIMH', 'LGR', 'LHM', 'LHU', 'LNK', 'LMA', 'LMABO', 'LMAO', 'MBO', 'LMHO', 'LMFAO', 'LMK', 'LOL', 'LOLA', 'LOML', 'LOMLILY', 'LOOL', 'LSHIPMP', 'LSHMBB', 'LSHMBH', 'LTNS', 'LTR', 'LTS', 'LULAS', 'LUWAMH', 'LY', 'LYK', 'LYL', 'LYLAB', 'LYLAS', 'M', 'MB', 'MYOB', 'M8', 'N2M', 'NE1', 'NETUA', 'NFI', 'NL', 'NM', 'NMH', 'NMJC', 'NOM', 'NOYB', 'NOYFB', 'NP', 'NPS', 'NTA', 'NS', 'NVM', 'OBTW', 'OF', 'OFIS', 'OMG', 'OOC', 'OT', 'OTOH', 'OTTOMH', 'PAH', 'PAW', 'PDS', 'PEBCAK', 'PIZ', 'PLZ', 'PM', 'PMJI', 'PMFJI', 'PMP', 'POAHF', 'POOF', 'POTB', 'POS', 'PPL', 'PS', 'PSA', 'Q4U', 'QSL', 'QSO', 'QT', 'RME', 'ROFL', 'ROFLAPMP', 'ROFLMAO', 'ROFLOLAY', 'ROFLOLUTS', 'ROTFL', 'RVD', 'RUTTM', 'RTF', 'RTFM', 'RTSM', 'S2R', 'SAMAGAL', 'SCNR', 'SETE', 'SH', 'SH', 'SHICPMP', 'SHID', 'SHMILY', 'SNAFU', 'SO', 'SOHF', 'SPAM', 'SRY', 'SSDD', 'STBY', 'STFU', 'STW', 'SWAK', 'SWALK', 'SWL', 'SIM', 'SITWB', 'SYS', 'SYSOP', 'TA', 'TCO', 'TGIF', 'THTH', 'THX', 'TIA', 'TIIC', 'TLA', 'TMA', 'TMI', 'TMS', 'TNX', 'TOH', 'TOY', 'TPTB', 'TSDMC', 'TT2T', 'TTT', 'TTUL', 'TTYIAM', 'TTYL', 'TTYLMF', 'TU', 'TWMA', 'TX', 'TY', 'TYVM', 'U2', 'UAPITA', 'UR', 'UW', 'VBG', 'VBS', 'W8', 'W8AM', 'WAY', 'WAY', 'WB', 'WBS', 'WDHLM', 'WDYWTTA', 'WE', 'WFM', 'WNDITWB', 'WP', 'WRT', 'WTF', 'WTG', 'WTH', 'WTMI', 'WUD', 'WUF', 'WUWT', 'WYMM', 'WYSIWYG', 'XTLA', 'Y2K', 'YATB', 'YBS', 'YG', 'YKYWTKM', 'YL', 'YM', 'YM', 'YMMD', 'YMMV', 'YVM', 'YW', 'YWIA', 'YWTHM', 'YWTLM', 'YWTKM', 'YOYO', 'YY4U']
#along=['as a matter of fact', 'about', 'any day now', "as far as I'm concerned", 'as far as I can tell', 'as far as I can see', 'as far as I know', 'as I understand it', 'also known as', 'as soon as possible', 'assistant section leader', 'age', 'age', 'assistant system operator', 'at this moment', 'as well as', 'are we having fun yet?', 'absent without leave', 'away without leave', 'at your own risk', 'before', 'bye for now', 'back at computer', 'be cool', 'big evil grin', 'boyfriend', 'bye for now', 'big grin', 'believe it or not', 'bite me', 'bite my bum', 'better known as', 'be right back', 'big red switch', 'bull shit', 'been there done that', 'be there or be square', 'beats the shit out of me', 'by the way', 'bring your own bottle', 'ctrl-alt-delete', "can't add", "couldn't do it without you", 'call for votes', 'calling for you', 'crying in disgrace', "correct me if I'm wrong", 'continue in next post', "can't remember shit", 'chuckle snicker grin', 'changing the subject', 'see you', 'see you too', 'see you later', 'see you later', 'complete waste of time', 'chat with you later', 'see ya', 'see ya later', 'see you online', 'doing business as', 'disconnected', 'disenhanced four-letter acronym', 'darling husband', 'darn if i know', 'digital guardian angel', 'do it yourself', "don't quote me on this", 'do not disturb', "don't worry about it", 'do what I mean', 'do what I mean', 'do what I say', "don't you just hate it when...", 'do you know', 'eating at keyboard', 'enough is enough', 'evil grin', 'excuse me for butting in', 'excuse me for jumping in', 'email message', 'end of discussion', 'end of file', 'end of lecture', 'end of message', 'end of story', 'end of thread', 'extended three letter acronym', 'excitable', 'female', 'face to face', 'frequently asked questions', 'for anyone who cares', 'for better or worse', 'fine', 'first come', 'for crying out loud', 'first in', 'first in', 'friend of a friend', 'fuck off bitch', 'free of charge', 'falling of chair laughing', 'falling on the floor laughing', 'freedom of speech', 'falling of the chair laughing', 'face to face', 'from time to time', 'fucked up', 'fucked up beyond all recognition', 'failed under continuas testing', 'full up ready to burst (about hard disk drives)', 'freeware', "for what it's worth", 'for your amusement', 'for your entertainment', 'for your eyes only', 'for your information', 'going to bed', 'got to go', 'got to go get something to drink', 'got to go take a crap', 'got to go take a pee', 'good afternoon', 'get away from it all', 'get a life', 'greetings and salutations', 'great big hug', 'garbled beyond recovery', 'god bless you', 'grin', 'good evening', 'girlfriend', 'grinning from ear to ear', 'gone for now', 'good for you', 'good game', 'good game you two', 'garbage in garbage out', 'good job', 'good luck', 'good luck and good hunting', 'good morning / good move / good match', 'give me a break', 'giggling my ass off', 'giggling my butt off', 'great minds think alike', 'good night', 'god only knows', 'get on with it', 'general protection fault', 'great', 'grinning', 'got to go', 'glad to see you', 'hug', 'hug and kiss', 'have a good day', 'have a good night', 'have a good summer', 'have a good one', 'having a heart attack', 'have a nice day', 'hug back', 'hurry back', 'how do you work this dratted thing', 'have fun', 'holding hands', 'hanging head in shame', 'ha ha', 'ha ha', 'ha ha', 'ha ha', 'hope it helps', "help I lapsed into a coma and can't log off", 'hate it when that happens', 'he loves me', 'home made smiley', 'hanging my self', "here's my try", 'homework', 'hold on a second', 'how should i know', 'hope this helps', 'hope this has been enlightening', 'hate you like my sister', 'I am an accountant', 'I am a lawyer', 'in any case', 'I see', 'in any event', 'I am gay', "I'm bucked naked", 'I could of course be wrong', "I don't care", "I don't get it", 'in a good way', 'I doubt it', "I don't know", "I'll drink to that", 'I feel very bad', 'I gotta pee', 'I get the point', 'I hate this f**king place', 'I hate you', 'I hate you', "I'm impressed", "I'm impressed too", 'if I recall', 'if I recall correctly', 'I just want to know', 'I just want to say', 'I know', 'I know what you mean', "I'll be seeing you", 'I love you', 'I love you', 'I love you forever and ever', 'in my arrogant opinion', 'in my f***ing arrogant opinion', 'in my bloody opinion', 'in my considered opinion', 'in my experience', 'in my humble opinion', 'in my', 'in my opinion', 'in my own biased opinion', 'in my point of view', 'I might be pregnant', "I'm not a lawyer", 'in no particular order', "I'm on Irish Time", 'in other words', 'in real life', 'I reply merely for information', 'it really sucks the big one', "I'm sorry", 'internet search environment number', 'it seems to me', 'I seem to recall', 'I see what you mean', 'in the final analysis', 'in the reality of', 'in the real world', 'if the shoe fits', 'in virtual live', 'I will always love you', 'it would be nice if', 'if you know what I mean', 'if you see what I mean', 'just a minute', 'just a second', 'just another system error', 'just another windows shell', 'just in case', 'just joking with you', 'just kidding', 'just my humble opinion', 'just my opinion', 'just playing', 'just to let you know', 'just wondering', 'OK', 'kiss', 'know how you feel', 'kiss back', 'keep it simple stupid', 'keep in touch', 'kiss my ass', 'kiss my butt', 'kiss my shiny metal ass', 'kiss on the cheek', 'kiss on the lips', 'keep up the good work', 'know what I mean?', 'later', 'later gator', "life's a bitch", 'leave a message', 'little boys room', 'long distance', 'lovely greetings', 'laughing in my head', 'little girls room', 'Lord help me', 'Lord help us', 'love and kisses', 'leave me alone', 'laughing my ass back on', 'laughing my ass off', 'laughing my butt off', 'laughing my head off', 'laughing my fat ass off', 'let me know', 'laughing out loud', 'laughing out loud again', 'light of my life (or love of my life)', 'light of my life', 'laughing out outrageously loud', 'laughing so hard I pissed my pants', 'laughing so hard my belly is bouncing', 'laughing so hard my belly hurts', 'long time no see', 'long term relationship', 'laughing to self', 'love you like a sister', 'love you with all my heart', 'love ya', 'let you know', 'love ya lots', 'love ya like a brother', 'love ya like a sister', 'male', 'maybe', 'mind your own business', 'mate', 'not too much', 'anyone', 'nobody ever tells us anything', 'no fucking idea', 'not likely', 'never mind ', 'not much here', 'nothing much', 'no offense meant', 'none of your business', 'none of your fucking business', 'no problem', 'no problem sweet', 'non-technical acronym', 'no shit', 'nevermind', 'oh', 'on fire', 'on floor with stitches', 'oh my god', 'out of character', 'Off topic', 'on the other hand', 'off the top of my head', 'parents at home', 'parents are watching', "please don't shoot", 'problem exists between chair and keyboard', 'parents in room', 'please', 'private message', 'pardon my jumping in (Another way for PMFJI)', 'pardon me for jumping in', 'peed my pants', 'put on a happy face', 'I have left the chat', 'pats on the back', 'parents over shoulder', 'people', 'post script', 'public show of affection', 'question for you', 'reply', 'conversation', 'cutie', 'rolling my eyses', 'rolling on floor laughing', 'rolling on floor laughing and peed my pants', 'rolling on floor laughing my ass off', 'rolling on floor laughing out loud at you', 'rolling on floor laughing out loud unable to speak', 'rolling on the floor laughing', 'really very dumb', 'are you talking to me', 'read the FAQ', 'read the fucking manual', 'read the stupid manual', 'send to receive', 'stop annoying me and get a live', 'sorry', 'smiling ear to ear', 'so hot', 'same here', 'so happy I could piss my pants', 'slaps head in disgust', 'see how much I love you', 'situation normal', 'significant other', 'sense of humor failure', "stupid persons' advertisement", 'sorry', 'same shit different day', 'sucks to be you', 'shut the fuck up', 'search the web', 'sealed with a kiss', 'sweet', 'screaming with laughter', 'shit', 'sorry', 'see you soon', 'system operator', 'thanks again', 'taken care of', 'thank god its Friday', 'to hot to handle', 'thanks', 'thanks in advance', 'the idiots in charge', 'three-letter acronym', 'take my advice', 'to much information', 'to much showing', 'thanks', 'to other half', 'thinking of you', 'the powers that be', 'tears streaming down my cheeks', 'to tired to talk', 'thought that', 'talk to you later', 'talk to you in a minute', 'talk to you later', 'talk to you later my friend', 'thank you', 'till we meet again', 'thanx', 'thank you', 'thank you very much', 'you too', "you're a pain in the ass", 'your', "you're welcom", 'very big grin', 'very big smile', 'wait', 'wait a minute', 'what about you', 'who are you', 'welcome back', 'write back soon', "why doesn't he love me", 'What Do You Want To Talk About', 'whatever', 'works for me', 'we never did it this way before', 'wrong person', 'with respect to', 'what the fuck', 'way to go', 'what the heck', 'way to much information', "what's up dog", 'where are you from', 'whats up with that', 'will you marry me', 'what you see is what you get', 'extended three letter acronym', "you're too kind", 'you are the best', "you'll be sorry", 'young gentleman', 'you know you want to kiss me', 'young lady', 'you mean', 'young man', "you've made my day", 'your mileage may vary', "you're very welcom", "you're welcome", "you're welcome in advance", 'you want to hug me', 'you want to love me', 'you want to kiss me', "you're on your own", 'two wise for you']
acron=['FYI', 'ETA', 'ASAP','AKA', 'ATM', 'TBA', 'RIP', 'PS', 'ESL', 'DIY', 'AFK', 'BRB', 'BBIAB', 'BBL', 'TTFN', 'BBS', 'BTW', 'KISS', 'KIT', 'EG', 'NYOB', 'OMG', 'PM', 'POS', 'TTYL', 'LTNS', 'SSDD', 'IDK', 'WTF','BS','LMK','LOL','ROFL','YOLO']
along=['For Your Information', 'Estimated Time of Arrival', 'As soon as possible','Also Known As', 'At the moment', 'To Be Announced', 'Rest in Peace', 'Post Script', 'English as a Second Language', 'Do it Yourself', 'Away From Keyboard', 'Be Right Back', 'Be Back In A Bit', 'Be Back Later', 'Ta Ta For Now', 'Be Back Soon', 'By The Way', 'Keep It Simple Stupid', 'Keep In Touch', 'Evil Grin', 'None of Your Business', 'Oh My God', 'Private Message', 'Parents Over Shoulder', 'Talk To You Later', 'Long Time No See', 'Same Shit Different Day', "I dont know", 'What the fuck','Bullshit', 'let me know', 'laughing out loud', 'Rolling On the Floor Laughing','you only live once']
# TRG=['faggot', 'poof', 'bum', 'dyke', 'fag', 'gay']
# target = 'Faggot' # poof' 'bum' 'dyke' 'fag'

limEntries = 1500

TRG=acron
ScoresShort=[]
for target in TRG:
    res = pd.read_sql_query("SELECT score "
                            "FROM May2015 "
                            #"WHERE LENGTH(body)<555 AND LENGTH(body)>1 "
                            # "AND score>0 "
                            #"AND body LIKE '% Trump %' " # COLLATE utf8_bin
                            "WHERE body LIKE '%" + target + "%' "
                            "AND score<"
                                                            "00 "
                            "ORDER BY RANDOM() LIMIT " + str(limEntries), conn)
    ScoresShort.append(round(res.values.mean(),1))
    print(target + ': '+str(round(res.values.mean(),1)))
    # Saving the objects:
    with open('saved_acron_scores', 'wb') as f:  # Python 3: open(..., 'wb')
        pickle.dump(ScoresShort, f)

TRG=along
ScoresLong=[]
for target in TRG:
    res = pd.read_sql_query("SELECT score "
                            "FROM May2015 "
                            #"WHERE LENGTH(body)<555 AND LENGTH(body)>1 "
                            #"AND body LIKE '% Trump %' " # COLLATE utf8_bin
                            "WHERE body LIKE '%" + target + "%' "
                            "AND score<500 "
                            "ORDER BY RANDOM() LIMIT " + str(limEntries), conn)
    ScoresLong.append(round(res.values.mean(),1))
    print(target + ': ' + str(round(res.values.mean(), 1)))
    # Saving the objects:
    with open('saved_along_scores', 'wb') as f:
        pickle.dump(ScoresLong, f)

# # Getting back the objects:
# with open('saved_acron_scores','rb') as f:  # Python 3: open(..., 'rb')
#     res = pickle.load(f)

endt = time.time()
print((endt - startt)/60)

conn.close()


# text_file1 = open("OutputTweet" + target + ".txt", "w")
# text_file2 = open("OutputTimes" + target + ".txt", "w")
# for item in res.values:
#     print("XXX: "+item[0])
#     text_file1.write("%s " % item[0])
#     text_file2.write("%s " % item[1])
# text_file1.close()
# text_file2.close()